<!DOCTYPE html>
<html>
<head>
<title>Numerical Analysis 3rd Edition Sauer </title>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
</head>

<h3>EXERCISES 4.3</h3>
\(\def\ds{\displaystyle} \)
<b>1 (a)</b> We follow the Gram-Schmidt procedure as outlined in Section 4.3.
Starting with the first column of the matrix \(A\),
\[y_1=A_1=
\left[\begin{array}{c}
4\\3\\
\end{array}\right]
\text{ and } r_{11}=||y_1||_2 = \sqrt{4^2+3^2}=5.
\]
The first unit vector is \[q_1 = \frac{A_1}{||A_1||_2} =
\left[\begin{array}{c}
4/5\\3/5\\
\end{array}\right].\]
Then
\[y_2 = A_2-q_1q_1^TA_2=
\left[\begin{array}{c}
0\\1\\
\end{array}\right]
-
\left[\begin{array}{c}
4/5\\3/5\\
\end{array}\right] \frac{3}{5} =
\left[\begin{array}{c}
-12/25\\16/25\\
\end{array}\right],
\]
\(r_{12}=q_1^TA_2 = 3/5, r_{22}=||y_2||_2 = 4/5\), and
\[q_2=\frac{y_2}{||y_2||_2} =
\left[\begin{array}{r}
-3/5\\4/5\\
\end{array}\right].\]
Putting the columns \(q_1, q_2\) together and filling in the matrix \(R\)
with \(r_{11}, r_{12}, r_{22}\), we have
\[A=
\left[\begin{array}{rr}
4&0\\3&1\\
\end{array}\right]=
\left[\begin{array}{rr}
4/5&-3/5\\3/5&4/5\\
\end{array}\right]
\left[\begin{array}{cc}
5&3/5\\0&4/5\\
\end{array}\right]=QR.
\]
<b>1 (b)</b> Starting with the first column of \({\ds A=
\left[\begin{array}{rr}
1&2\\1&1\\
\end{array}\right]}\),
\[y_1=A_1=
\left[\begin{array}{c}
1\\1\\
\end{array}\right]
\text{ and } r_{11}=||y_1||_2=\sqrt{1^2+1^2}=\sqrt{2}.
\]
The first column of \(Q\) is \({\ds q_1=A_1/||A_1||_2 = [1/\sqrt{2},1/\sqrt{2}]^T}\).
Then \[y_2=A_2-q_1q_1^TA_2 =
\left[\begin{array}{c}
2\\1\\
\end{array}\right]-
\left[\begin{array}{c}
1/\sqrt{2}\\1/\sqrt{2}\\
\end{array}\right]\frac{3}{\sqrt{2}} =
\left[\begin{array}{r}
1/2\\-1/2\\
\end{array}\right],
\]
\(r_{12}=3/\sqrt{2}, r_{22}=||y_2||_2=1/\sqrt{2}, q_2=[1/\sqrt{2}, -1/\sqrt{2}]^T\),
and the QR factorization is
\[A=
\left[\begin{array}{rr}
1&2\\1&1\\
\end{array}\right]=
\left[\begin{array}{rr}
1/\sqrt{2}&1/\sqrt{2}\\1/\sqrt{2}&-1/\sqrt{2}\\
\end{array}\right]
\left[\begin{array}{cc}
\sqrt{2}&3/\sqrt{2}\\0&1/\sqrt{2}\\
\end{array}\right]=QR.
\]
<b>1 (c)</b> Starting with the first column of \({\ds A=
\left[\begin{array}{rr}
2&1\\1&-1\\2&1\\
\end{array}\right]}\),
\[y_1=A_1=
\left[\begin{array}{c}
2\\1\\2\\
\end{array}\right]
\text{ and } r_{11}=||y_1||_2=\sqrt{2^2+1^2+2^2}=3.
\]
The first column of \(Q\) is \({\ds q_1=A_1/||A_1||_2 = [2/3, 1/3, 2/3]^T}\).
Then \[y_2=A_2-q_1q_1^TA_2 =
\left[\begin{array}{r}
1\\-1\\1\\
\end{array}\right]-
\left[\begin{array}{c}
2/3\\1/3\\2/3\\
\end{array}\right]1 =
\left[\begin{array}{r}
1/3\\-4/3\\1/3
\end{array}\right],
\]
\(r_{12}=1, r_{22}=||y_2||_2=\sqrt{2},
q_2=y_2/r_{22}=[\sqrt{2}/6, -2\sqrt{2}/3, \sqrt{2}/6]^T\).
In order to make \(Q\) square, we need a third column. To orthogonalize a
"random" vector \([1,0,0]\), we compute
\[y_3=A_3-q_1q_1^TA_3- q_2q_2^TA_3=
\left[\begin{array}{r}
1\\0\\0\\
\end{array}\right]-\frac{2}{3}
\left[\begin{array}{c}
2/3\\1/3\\2/3\\
\end{array}\right]-
\frac{\sqrt{2}}{6}
\left[\begin{array}{c}
\sqrt{2}/6\\-2\sqrt{2}/3\\\sqrt{2}/6\\
\end{array}\right]
 =
\left[\begin{array}{r}
1/2\\0\\-1/2
\end{array}\right],
\]
while \(q_3 = [1/2,0,-1/2]^T/||q_3||_2 = [\sqrt{2}/2,0,-\sqrt{2}/2]^T\).
The QR factorization is
\[A=
\left[\begin{array}{rr}
2&1\\1&-1\\2&1\\
\end{array}\right]=
\left[\begin{array}{rrr}
2/3&\sqrt{2}/6&\sqrt{2}/2\\
1/3&-4\sqrt{2}/6&0\\
2/3&\sqrt{2}/6&-\sqrt{2}/2\\
\end{array}\right]
\left[\begin{array}{cc}
3&1\\0&\sqrt{2}\\0&0\\
\end{array}\right]=QR.
\]
<b>1 (d)</b> Starting with the first column of \({\ds A=
\left[\begin{array}{rrr}
4&8&1\\0&2&-2\\3&6&7\\
\end{array}\right]}\),
\[y_1=A_1=
\left[\begin{array}{c}
4\\0\\3\\
\end{array}\right]
\text{ and } r_{11}=||y_1||_2=5.
\]
The first column of \(Q\) is \({\ds q_1=A_1/||A_1||_2 = [4/5,0, 3/5]^T}\).
Then \[y_2=A_2-q_1q_1^TA_2 =
\left[\begin{array}{r}
8\\2\\6\\
\end{array}\right]-
\left[\begin{array}{c}
4/5\\0\\3/5\\
\end{array}\right]10 =
\left[\begin{array}{r}
0\\2\\0
\end{array}\right],
\]
\(r_{12}=10, r_{22}=||y_2||_2=2,
q_2=y_2/r_{22}=[0, 1, 0]^T\).
The third column of \(A\) is orthogonalized by
\[y_3=A_3-q_1q_1^TA_3- q_2q_2^TA_3=
\left[\begin{array}{r}
1\\-2\\7\\
\end{array}\right]-
\left[\begin{array}{c}
4/5\\0\\3/5\\
\end{array}\right]5-
\left[\begin{array}{c}
0\\1\\0\\
\end{array}\right](-2)
 =
\left[\begin{array}{r}
-3\\0\\4
\end{array}\right],
\]
while \(q_3 = [-3,0, 4]^T/||y_3||_2 = [-3/5, 0, 4/5]^T\), and \(r_{33}=5\).
The QR factorization is
\[A=
\left[\begin{array}{rrr}
4&8&1\\0&2&-2\\3&6&7\\
\end{array}\right]=
\left[\begin{array}{rrr}
4/5&0&-3/5\\
0&1&0\\
3/5&0&4/5\\
\end{array}\right]
\left[\begin{array}{rrr}
5&10&5\\
0&2&-2\\
0&0&5\\
\end{array}\right]=QR.
\]
<hr>

<b>3</b> The Modified Gram-Schmidt is different than the classical version only for part (d), and in exact arithmetic, the difference is only in the order of operations. In 3(d), the first two columns of \(Q\) are carried out the same as the classical version.
The first column of \(Q\) is \({\ds q_1=A_1/||A_1||_2 = [4/5,0, 3/5]^T}\) with
\(r_{11}=||y_1||_2=5,\)
and the second column is calculated as \[y_2=A_2-q_1q_1^TA_2 =
\left[\begin{array}{r}
8\\2\\6\\
\end{array}\right]-
\left[\begin{array}{c}
4/5\\0\\3/5\\
\end{array}\right]10 =
\left[\begin{array}{r}
0\\2\\0
\end{array}\right],
\]
\(r_{12}=10, r_{22}=||y_2||_2=2,
q_2=y_2/r_{22}=[0, 1, 0]^T\).
While the Classical Gram-Schmidt would orthogonalize the third column of \(A\) by
\(y_3=A_3-q_1q_1^TA_3- q_2q_2^TA_3\), Modified Gram-Schmidt orthogonalizes by
\begin{eqnarray*}
y_3&=&A_3-q_1q_1^TA_3- q_2q_2^T(A_3-q_1q_1^TA_3)\\
&=&
\left[\begin{array}{r}
1\\-2\\7\\
\end{array}\right]-
\left[\begin{array}{c}
4/5\\0\\3/5\\
\end{array}\right]5
- \left[\begin{array}{c}
0\\1\\0\\
\end{array}\right]
\left(\left[\begin{array}{ccc}
0&1&0
\end{array}\right]
\left[\begin{array}{r}
-3\\-2\\4\\
\end{array}\right]\right)
 =
\left[\begin{array}{r}
-3\\0\\4
\end{array}\right],
\end{eqnarray*}
and thus \(q_3 = [-3,0, 4]^T/||y_3||_2 = [-3/5, 0, 4/5]^T\), and \(r_{33}=5\).
The QR factorization is
\[A=
\left[\begin{array}{rrr}
4&8&1\\0&2&-2\\3&6&7\\
\end{array}\right]=
\left[\begin{array}{rrr}
4/5&0&-3/5\\
0&1&0\\
3/5&0&4/5\\
\end{array}\right]
\left[\begin{array}{rrr}
5&10&5\\
0&2&-2\\
0&0&5\\
\end{array}\right]=QR.
\]
<hr>

<b>5 (a)</b> We begin by applying a Householder reflector to transform the
first column to the \(x\)-axis. Set \(x=[4,3]^T\) and \(w=[||x||_2,0]^T = [5,0]^T\).
(An alternative, and often preferred choice, is \(w=-[||x||_2,0]^T\).)
Define \(v=w-x=[1, -3]^T\). The reflector is
\[H=I-\frac{2vv^T}{v^Tv} =
\left[\begin{array}{rr}
1&0\\0&1\\
\end{array}\right]
-\frac{2}{10}
\left[\begin{array}{rr}
1&-3\\-3&9\\
\end{array}\right]=
\left[\begin{array}{rr}
0.8&0.6\\0.6&-0.8
\end{array}\right].\]
Multiplying the matrix on the left by \(H\) yields
\[HA=
\left[\begin{array}{rr}
0.8&0.6\\0.6&-0.8
\end{array}\right]
\left[\begin{array}{rr}
4&0\\3&1\\
\end{array}\right]=
\left[\begin{array}{rr}
5&0.6\\0&-0.8
\end{array}\right]=R.
\]
Multiplying by \(H\) on the left,
\[A=
\left[\begin{array}{rr}
4&0\\3&1\\
\end{array}\right]=
\left[\begin{array}{rr}
0.8&0.6\\0.6&-0.8
\end{array}\right]
\left[\begin{array}{rr}
5&0.6\\0&-0.8
\end{array}\right]=QR,\]
where \(Q\) is defined to be the orthogonal matrix \(H\). <p>
<b>5 (b)</b> Let \(x=[1,1]^T\) be the first column, and set \(w=[\sqrt{2},0]^T\).
The Householder reflector for \(v=w-x=[\sqrt{2}-1,-1]\) is
\[H=I-\frac{2vv^T}{v^Tv} =
\left[\begin{array}{rr}
1&0\\0&1\\
\end{array}\right]
-\frac{2}{4-2\sqrt{2}}
\left[\begin{array}{rr}
3-2\sqrt{2}&1-\sqrt{2}\\
1-\sqrt{2}&1\\
\end{array}\right]=
\left[\begin{array}{rr}
1/\sqrt{2}&1/\sqrt{2}\\1/\sqrt{2}&-1/\sqrt{2}\\
\end{array}\right].\]
Multiplying by \(A\) yields
\[HA=\left[\begin{array}{rr}
1/\sqrt{2}&1/\sqrt{2}\\1/\sqrt{2}&-1/\sqrt{2}\\
\end{array}\right]
\left[\begin{array}{rr}
1&2\\1&1\\
\end{array}\right]=
\left[\begin{array}{rr}
\sqrt{2}&3/\sqrt{2}\\0&1/\sqrt{2}\\
\end{array}\right].\]
Multiplying by \(H\) on the left and setting \(Q=H\) reveals the QR factorization
\[A=
\left[\begin{array}{rr}
1&2\\1&1\\
\end{array}\right]=
\left[\begin{array}{rr}
1/\sqrt{2}&1/\sqrt{2}\\1/\sqrt{2}&-1/\sqrt{2}\\
\end{array}\right]
\left[\begin{array}{rr}
\sqrt{2}&3/\sqrt{2}\\0&1/\sqrt{2}\\
\end{array}\right]=QR.\]

<b>5 (c)</b> Denote by \(x=[2,1,2]^T\) the first column and set
\(w=[||x||_2,0,0]^T=[3,0,0]^T\), and \(v=w-x=[1, -1, -2]^T\). The
first Householder reflector is
\[H_1=I-\frac{2vv^T}{v^Tv} =
\left[\begin{array}{rrr}
1&0&0\\0&1&0\\0&0&1\\
\end{array}\right]
-\frac{2}{6}
\left[\begin{array}{rrr}
1&-1&-2\\-1&1&2\\-2&2&4\\
\end{array}\right]=
\left[\begin{array}{rrr}
2/3&1/3&2/3\\
1/3&2/3&-2/3\\
2/3&-2/3&-1/3\\
\end{array}\right].\]
Multiplying the matrix \(A\) on the left by \(H_1\) yields
\[H_1A=
\left[\begin{array}{rrr}
2/3&1/3&2/3\\
1/3&2/3&-2/3\\
2/3&-2/3&-1/3\\
\end{array}\right]
\left[\begin{array}{rr}
2&1\\1&-1\\2&1\\
\end{array}\right]=
\left[\begin{array}{rr}
3&1\\0&-1\\0&1\\
\end{array}\right].
\]
To finish, we need to find a \(2\times 2\) matrix \(\hat{H}_2\) that moves
the vector \(x_2=[-1,1]^T\) to the \(x\)-axis. Set \(w_2=[||x_2||_2,0]^T\)
and \(v_2=w_2-x_2=[\sqrt{2}+1, -1]^T\). Then
\[\hat{H}_2=I-\frac{2v_2v_2^T}{v_2^Tv_2} =
\left[\begin{array}{rr}
1&0\\0&1\\
\end{array}\right]
-\frac{2}{4+2\sqrt{2}}
\left[\begin{array}{cc}
3+2\sqrt{2}&-\sqrt{2}-1\\
-\sqrt{2}-1&1\\
\end{array}\right]=
\left[\begin{array}{rr}
-1/\sqrt{2}&1/\sqrt{2}\\
1/\sqrt{2}&1/\sqrt{2}\\
\end{array}\right],\]
and
\[H_2H_1A=
\left[\begin{array}{rrr}
1&0&0\\
0&-1/\sqrt{2}&1/\sqrt{2}\\
0&1/\sqrt{2}&1/\sqrt{2}\\
\end{array}\right]
\left[\begin{array}{rr}
3&1\\0&-1\\0&1\\
\end{array}\right]=
\left[\begin{array}{rr}
3&1\\0&\sqrt{2}\\0&0\\
\end{array}\right].\]
Multiplying on the left by \(H_1H_2\) yields
\begin{eqnarray*}A=
\left[\begin{array}{rr}
2&1\\1&-1\\2&1\\
\end{array}\right]&=&
\left[\begin{array}{rrr}
2/3&1/3&2/3\\
1/3&2/3&-2/3\\
2/3&-2/3&-1/3\\
\end{array}\right]
\left[\begin{array}{rrr}
1&0&0\\
0&-1/\sqrt{2}&1/\sqrt{2}\\
0&1/\sqrt{2}&1/\sqrt{2}\\
\end{array}\right]
\left[\begin{array}{rr}
3&1\\0&\sqrt{2}\\0&0\\
\end{array}\right]\\
&=&
\left[\begin{array}{ccc}
2/3&\sqrt{2}/6&1/\sqrt{2}\\
1/3&-2\sqrt{2}/3&0\\
2/3&\sqrt{2}/6&-1/\sqrt{2}\\
\end{array}\right]
\left[\begin{array}{rr}
3&1\\0&\sqrt{2}\\0&0\\
\end{array}\right]=QR.
\end{eqnarray*}
<b>5 (d)</b> Let \(x=[4,0,3]^T\) denote the first column, \(w=[5,0,0]^T\), and
\(v=w-x=[1,0,-3]^T\). The Householder reflector is
\[H=I-\frac{2vv^T}{v^Tv} =
\left[\begin{array}{rrr}
1&0&0\\0&1&0\\0&0&1\\
\end{array}\right]
-\frac{2}{10}
\left[\begin{array}{rrr}
1&0&-3\\0&0&0\\-3&0&9\\
\end{array}\right]=
\left[\begin{array}{rrr}
0.8&0.0&0.6\\
0.0&1.0&0.0\\
0.6&0.0&-0.8\\
\end{array}\right].\]
Multiplying the matrix \(A\) on the left by \(H\) yields
\[HA=
\left[\begin{array}{rrr}
0.8&0.0&0.6\\
0.0&1.0&0.0\\
0.6&0.0&-0.8\\
\end{array}\right]
\left[\begin{array}{rrr}
4&8&1\\0&2&-2\\3&6&7\\
\end{array}\right]=
\left[\begin{array}{rrr}
5&10&5\\0&2&-2\\0&0&-5\\
\end{array}\right],
\]
and multiplying by \(H\) on the left gives
\begin{eqnarray*}A=
\left[\begin{array}{rrr}
4&8&1\\0&2&-2\\3&6&7\\
\end{array}\right]&=&
\left[\begin{array}{rrr}
0.8&0.0&0.6\\
0.0&1.0&0.0\\
0.6&0.0&-0.8\\
\end{array}\right]
\left[\begin{array}{rrr}
5&10&5\\0&2&-2\\0&0&-5\\
\end{array}\right]=QR.
\end{eqnarray*}
<hr>

<b>7 (a)</b> Using the QR factorization
\[A=
\left[\begin{array}{rr}
2&3\\-2&-6\\1&0\\
\end{array}\right]=
\left[\begin{array}{rrr}
2/3&1/3&2/3\\
-2/3&2/3&1/3\\
1/3&2/3&-2/3\\
\end{array}\right]
\left[\begin{array}{rr}
3&6\\0&-3\\0&0\\
\end{array}\right]=QR,
\]
we proceed as in Example 4.14. The system \(Rx=Q^Tb\) is
\[
\left[\begin{array}{rr}
3&6\\0&-3\\0&0\\
\end{array}\right]
\left[\begin{array}{r}
x_1\\x_2\\
\end{array}\right]=
\left[\begin{array}{rrr}
2/3&-2/3&1/3\\
1/3&2/3&2/3\\
2/3&1/3&-2/3\\
\end{array}\right]
\left[\begin{array}{r}
3\\-3\\6\\
\end{array}\right]=
\left[\begin{array}{r}
6\\3\\-3\\
\end{array}\right].\]
The top two equations
\begin{eqnarray*}
3x_1+6x_2&=& 6\\
-3x_2&=& 3
\end{eqnarray*}
have solutions \(x_2=-1, x_1=4\). The least squares solution is
\(\overline{x}=[4,-1]^T\). <p>
<b>7 (b)</b> Similar to (a). Using the QR factorization
\[A=
\left[\begin{array}{rr}
-4&-4\\-2&7\\4&-5\\
\end{array}\right]=
\left[\begin{array}{rrr}
2/3&2/3&1/3\\
1/3&-2/3&2/3\\
-2/3&1/3&2/3\\
\end{array}\right]
\left[\begin{array}{rr}
-6&3\\0&-9\\0&0\\
\end{array}\right]=QR,
\]
the system \(Rx=Q^Tb\) is
\[
\left[\begin{array}{rr}
-6&3\\0&-9\\0&0\\
\end{array}\right]
\left[\begin{array}{r}
x_1\\x_2\\
\end{array}\right]=
\left[\begin{array}{rrr}
2/3&1/3&-2/3\\
2/3&-2/3&1/3\\
1/3&2/3&2/3\\
\end{array}\right]
\left[\begin{array}{r}
3\\9\\0\\
\end{array}\right]=
\left[\begin{array}{r}
5\\-4\\7\\
\end{array}\right].\]
The top two equations
\(
-6x_1+3x_2=5\) and
\(-9x_2= -4\)
have solutions \(x_2=4/9, x_1=-11/18\). The least squares solution is
\(\overline{x}=[-11/18,4/9]^T\).
<hr>

<b>9</b>  By definition, a matrix \(Q\) is orthogonal if \(Q^{-1}=Q^T\).
Note that the \((i,j)\)th entry of the product \(Q^TQ\) is the dot product
\(q_i^Tq_j\). If \(Q\) is orthogonal, \(q_i^Tq_j = 1\) if \(i=j\) and \(0\)
if \(i\neq j\), showing that the columns are pairwise orthogonal unit
vectors. Conversely, if the latter holds, \(Q^TQ=I\) and since \(Q\) is
square, \(Q^T=Q^{-1}\).
<hr>

<b>11</b> Each dot product \(q_k^Tv_j\) in equation (4.25) together with
a scalar multiplication of the result with \(q_k\) requires \(2m\)
multiplications and \(m-1\) additions. There are \(j-1\) of these in
(4.25), for a total of \(2m(j-1)\) multiplications and \((j-1)(m-1)\)
additions. Computing the sum of the \(j\) vectors in (4.25) requires
\((j-1)m\) more additions. Making the unit vector \(q_j\) requires
\(m\) multiplications, \(m\) divisions, and \(m-1\) additions. Therefore
the total operation count of multiplication/divisions is
\[\sum_{j=1}^m 2mj = 2m\frac{m(m+1)}{2}=m^3+m^2\]
and of additions is
\begin{eqnarray*}
\sum_{j=1}^m (j-1)(2m-1)+m-1&=&(2m-1)\sum_{j=1}^m (j-1)+(m-1)m\\
&=&\frac{(2m-1)(m-1)m}{2}+m(m-1)\\
&=&m(m-1)(m+\frac{1}{2})\\
&=&m^3-\frac{1}{2}m^2-\frac{1}{2}m.
\end{eqnarray*}
<hr>

<b>13(a)</b>
\(\ds
P^2 = \frac{vv^T}{v^Tv} \frac{vv^T}{v^Tv} = \frac{vv^T vv^T}{v^Tv v^Tv} = \frac{vv^T}{v^Tv} = P
\)<p>
<b>13(b)</b>
\(\ds
P^T = \left( \frac{vv^T}{v^Tv}\right)^T = \frac{1}{v^Tv}(vv^T)^T = \frac{1}{v^Tv}(vv^T) = P
\)<p>
<b>13(c)</b>
\(\ds
Pv = \frac{vv^T}{v^Tv}v = v\frac{v^Tv}{v^Tv} = v
\)<p>


</html>
