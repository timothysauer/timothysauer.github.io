<!DOCTYPE html>
<html>
<head>
<title>Numerical Analysis 3rd Edition Sauer </title>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"> </script>
</head>

<h3>COMPUTER PROBLEMS 4.3</h3>
\(\def\ds{\displaystyle} \)
<b>1</b> Python code  for Modified Gram-Schmidt orthogonalization differs from Classical by a few keystrokes: <p>
<pre>
import numpy as np

def clgs(A):
    """ Modified Gram-Schmidt orthogonalization
    Input:  A mxn matrix with linearly independent columns
    Output: Q orthogonal matrix
            R upper triangular matrix """
    m, n = A.shape
    Q = np.zeros((m,n))
    R = np.zeros((n,n))
    for j in range(n):
        y = A[:,j].copy()
        for i in range(j):
            R[i,j] = np.dot(Q[:,i], y)  # Inner product
            y -= R[i,j]*Q[:,i]   # Subtract the projection
        R[j,j] = np.linalg.norm(y)  # Norm of y
        Q[:,j] = y/R[j,j]  # Normalize y to form the j-th column of Q
    return Q, R
</pre>
<hr>

<b>3</b> For \(n=5\), the results are: <p>

Classical Gram-Schmidt:

<pre>
A =

   1.000000000000000   1.000000000000000   1.000000000000000   1.000000000000000   1.000000000000000
   0.000000000100000                   0                   0                   0                   0
                   0   0.000000000100000                   0                   0                   0
                   0                   0   0.000000000100000                   0                   0
                   0                   0                   0   0.000000000100000                   0
                   0                   0                   0                   0   0.000000000100000


Q =

   1.000000000000000                   0                   0                   0                   0
   0.000000000100000  -0.707106781186548  -0.707106781186548  -0.707106781186548  -0.707106781186548
                   0   0.707106781186548                   0                   0                   0
                   0                   0   0.707106781186548                   0                   0
                   0                   0                   0   0.707106781186548                   0
                   0                   0                   0                   0   0.707106781186548


R =

   1.000000000000000   1.000000000000000   1.000000000000000   1.000000000000000   1.000000000000000
                   0   0.000000000141421                   0                   0                   0
                   0                   0   0.000000000141421                   0                   0
                   0                   0                   0   0.000000000141421                   0
                   0                   0                   0                   0   0.000000000141421


orthogtest =

   1.000000000000000  -0.000000000070711  -0.000000000070711  -0.000000000070711  -0.000000000070711
  -0.000000000070711   1.000000000000000   0.500000000000000   0.500000000000000   0.500000000000000
  -0.000000000070711   0.500000000000000   1.000000000000000   0.500000000000000   0.500000000000000
  -0.000000000070711   0.500000000000000   0.500000000000000   1.000000000000000   0.500000000000000
  -0.000000000070711   0.500000000000000   0.500000000000000   0.500000000000000   1.000000000000000
</pre>
<p>

Modified Gram-Schmidt:

<pre>
A =

   1.000000000000000   1.000000000000000   1.000000000000000   1.000000000000000   1.000000000000000
   0.000000000100000                   0                   0                   0                   0
                   0   0.000000000100000                   0                   0                   0
                   0                   0   0.000000000100000                   0                   0
                   0                   0                   0   0.000000000100000                   0
                   0                   0                   0                   0   0.000000000100000


Q =

   1.000000000000000                   0                   0                   0                   0
   0.000000000100000  -0.707106781186548  -0.408248290463863  -0.288675134594813  -0.223606797749979
                   0   0.707106781186548  -0.408248290463863  -0.288675134594813  -0.223606797749979
                   0                   0   0.816496580927726  -0.288675134594813  -0.223606797749979
                   0                   0                   0   0.866025403784439  -0.223606797749979
                   0                   0                   0                   0   0.894427190999916


R =

   1.000000000000000   1.000000000000000   1.000000000000000   1.000000000000000   1.000000000000000
                   0   0.000000000141421   0.000000000070711   0.000000000070711   0.000000000070711
                   0                   0   0.000000000122474   0.000000000040825   0.000000000040825
                   0                   0                   0   0.000000000115470   0.000000000028868
                   0                   0                   0                   0   0.000000000111803


orthogtest =

   1.000000000000000  -0.000000000070711  -0.000000000040825  -0.000000000028868  -0.000000000022361
  -0.000000000070711   1.000000000000000  -0.000000000000000  -0.000000000000000  -0.000000000000000
  -0.000000000040825  -0.000000000000000   1.000000000000000  -0.000000000000000  -0.000000000000000
  -0.000000000028868  -0.000000000000000  -0.000000000000000   1.000000000000000   0.000000000000000
  -0.000000000022361  -0.000000000000000  -0.000000000000000   0.000000000000000   1.000000000000000
</pre>
<p>

Householder reflections:

<pre>
A =

   1.000000000000000   1.000000000000000   1.000000000000000   1.000000000000000   1.000000000000000
   0.000000000100000                   0                   0                   0                   0
                   0   0.000000000100000                   0                   0                   0
                   0                   0   0.000000000100000                   0                   0
                   0                   0                   0   0.000000000100000                   0
                   0                   0                   0                   0   0.000000000100000


Q =

  -1.000000000000000   0.000000000070711   0.000000000040825   0.000000000028868   0.000000000022361  -0.000000000044721
  -0.000000000100000  -0.707106781186547  -0.408248290463863  -0.288675134594813  -0.223606797749979   0.447213595499958
                   0   0.707106781186547  -0.408248290463863  -0.288675134594813  -0.223606797749979   0.447213595499958
                   0                   0   0.816496580927726  -0.288675134594813  -0.223606797749979   0.447213595499958
                   0                   0                   0   0.866025403784438  -0.223606797749979   0.447213595499958
                   0                   0                   0                   0   0.894427190999916   0.447213595499958


R =

  -1.000000000000000  -1.000000000000000  -1.000000000000000  -1.000000000000000  -1.000000000000000
                   0   0.000000000141421   0.000000000070711   0.000000000070711   0.000000000070711
                   0                   0   0.000000000122474   0.000000000040825   0.000000000040825
                   0                   0   0.000000000000000   0.000000000115470   0.000000000028868
                   0                   0   0.000000000000000                   0   0.000000000111803
                   0                   0  -0.000000000000000                   0   0.000000000000000


orthogtest =

   1.000000000000000                   0  -0.000000000000000                   0   0.000000000000000  -0.000000000000000
                   0   1.000000000000000  -0.000000000000000  -0.000000000000000  -0.000000000000000   0.000000000000000
  -0.000000000000000  -0.000000000000000   1.000000000000000  -0.000000000000000   0.000000000000000   0.000000000000000
                   0  -0.000000000000000  -0.000000000000000   1.000000000000000   0.000000000000000  -0.000000000000000
   0.000000000000000  -0.000000000000000   0.000000000000000   0.000000000000000   1.000000000000000   0.000000000000000
  -0.000000000000000   0.000000000000000   0.000000000000000  -0.000000000000000   0.000000000000000   1.000000000000000
</pre>
<p>

 It is clear that Householder is most accurate, followed by Modified Gram-Schmidt.
<hr>

<b>5 (a)</b> The full \(A=QR\) factorization of the \(m\times n\) matrix \(A\) is 
\[\left[\begin{array}{rr}
1&1\\
2&1\\
1&2\\
0&3
\end{array}\right]=
\left[\begin{array}{rrrr}
   - 0.4082&    0.0506 &   -0.6474&    -0.6416\\
    -0.8165&   -0.2025&   --0.0356&   0.5395\\
    -0.4082&    0.3545&   0.7186 &   -0.4374\\
         0.0000&    0.9115&    -0.2514 &  0.3256
\end{array}\right]
\left[\begin{array}{rr}
    -2.4495&    -2.0412\\
      0.0000&       3.2914\\
         0.0000&         0.0000\\
         0.0000&         0.0000
\end{array}\right].
\]
The upper \(n\) entries of \({\ds d=Q^Tb =
\left[\begin{array}{r}
   -7.3485\\
    5.4688\\
    0.2158\\
    0.2139
    \end{array}\right]}\)
are     \({\ds \hat{d} = 
 \left[\begin{array}{r}
   -7.3485\\
    5.4688
    \end{array}\right]}\). <p> Solving \(
    \hat{R}\overline{x}=\hat{d}\), or \({\ds 
\left[\begin{array}{rr}
    2.4495&    2.0412\\
      0.0000&       3.2914\\
\end{array}\right]
\left[\begin{array}{r}
x_1\\x_2
\end{array}\right]
    = \left[\begin{array}{r}
   -7.3485\\
    5.4688
    \end{array}\right]    }\), yields 
\({\ds \overline{x}=   
 \left[\begin{array}{r}
1.6154\\1.6615
\end{array}\right].   }\) <p>
    
<b>5 (b)</b> The full \(A=QR\) factorization of the \(m\times n\) matrix \(A\) is 
\[\left[\begin{array}{rrr}
1&2&2\\
2&-1&2\\
3&1&1\\
1&1&-1
\end{array}\right]=
\left[\begin{array}{rrrr}
    -0.2582&    0.7116&    0.6290&    0.1771\\
    -0.5164&   -0.6295&    0.3755&    0.4428\\
    -0.7746 &   0.0821&   -0.2488 &  -0.5756\\
    -0.2582 &   0.3011&   -0.6337&    0.6642
\end{array}\right]
\left[\begin{array}{rrr}
    -3.8730&    -1.0328&    -2.0656\\
         0.0000&    2.4358&   -0.0547\\
         0.0000&         0.0000&    2.3938\\
         0.0000&         0.0000&         0.0000
\end{array}\right].
\]
The upper \(n\) entries of \({\ds d=Q^Tb =
\left[\begin{array}{r}
   13.6845\\
    5.6928\\
    3.7785\\
    0.2214
    \end{array}\right]}\)
are     \({\ds \hat{d} = 
 \left[\begin{array}{r}
   13.6845\\
    5.6928\\
    3.7785
    \end{array}\right]}\). <p> Solving \(
    \hat{R}\overline{x}=\hat{d}\),  or \({\ds 
\left[\begin{array}{rrr}
    3.8730&    1.0328&    2.0656\\
         0.0000&    2.4358&   -0.0547\\
         0.0000&         0.0000&    2.3938
\end{array}\right]
\left[\begin{array}{r}
x_1\\x_2\\x_3
\end{array}\right]
    = \left[\begin{array}{r}
   13.6845\\
    5.6928\\
    3.7785
    \end{array}\right]    }\), yields 
\({\ds \overline{x}=   
 \left[\begin{array}{r}
    2.0588\\
    2.3725\\
    1.5784
\end{array}\right].   }\)
<hr>

<b>7 (a)</b> The matrix can be formed by the command
<pre>
a = scipy.linalg.hilbert(10)
a = a[:,:n]
</pre>
The correct solution \(\overline{x}=[1,\ldots,1]\) can be computed
to about 10 correct decimal places. <p>
<b>7 (b)</b> Similar to (a), but with \(n=8\). The correct \(\overline{x}=
[1,\ldots,1]\)
can be computed to about 6 correct places.

</html>